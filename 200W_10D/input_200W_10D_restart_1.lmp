## LAMMPS input start file for filtration research  
## Written by Kevin Van Slyke  
## Dated: 04_02_2018

read_restart 200W_10D_archive.restart 
## Multi neighbor and comm for efficiency 
neighbor    1 multi 
neigh_modify    delay 0 
comm_modify    mode multi 

thermo    1000    #Print thermo vars every 1000 timesteps 

## Thermodynamic calculation method and dynamics 
fix    1 gas nve    #Fix microcanonical ensemble 
fix    2 filter setforce 0.0 0.0 0.0  #Fix force on filter to zero 
fix    3 gas wall/reflect ylo 0 yhi 2000    #Fix walls parallel to xz plane at y=0 and y=2000 to reflect particles 
fix    4 all enforce2d    #Fix motion along the z-axis to simulate 2D 

## Compute thermodynamic temperature based only on gas molecules 
compute    gasTemp gas temp 

## Define regions in which Pressure will be calculated and inside of the pore 
region    pressureRegion block 900 1000 0 2000 -0.01 0.01 
group    pressureGroup dynamic gas region pressureRegion every 1000 
compute    Pp pressureGroup stress/atom gasTemp ke pair 
compute    Ps pressureGroup reduce sum c_Pp[1] c_Pp[2] 
variable    Px equal -(c_Ps[1])/(100*2000) 
variable    Py equal -(c_Ps[2])/(100*2000) 
variable    P equal (v_Px+v_Py)/2 

thermo_style    custom step etotal ke pe c_gasTemp press v_P 

variable movieTimes equal stride2(1000000,3000100,1000100,1000000,1100000,100) 
## Extra dump of mass and position in the region around the pore for making movies 
region    rawPore block 875 1125 875 1125 0 0    #Define region immediately inside pore to use for dumping atom data 
group    rawMovie dynamic all region rawPore every 100    #Make a dynamic group of particles in pore region every N=100 timesteps 
dump    10 rawMovie custom 100 dump_200W_10D_rawMovie_restart_1.lmp type x y    #Dump pore group atom data every N=100 timesteps to file dump_200W_10D_rawMovie_restart_1.lmp including atom: type, x position, y position in that order 
dump_modify 10 flush yes every v_movieTimes 
thermo_modify flush yes 
restart 100000 200W_10D_archive.restart 200W_10D_backup.restart 
restart 1000000 200W_10D_archive.restart 
run 1000001 pre yes post yes 
